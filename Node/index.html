<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Coincidence</title>
  <link rel="stylesheet" href="css/bootstrap.min.css">
  <link rel="stylesheet" href="css/style.css">
</head>

<body>
  <div class="row " style="width: 99%">
    <ul class="nav nav-tabs">
      <li class="active"><a data-toggle="tab" href="#matrix">Matrix</a></li>
      <li class="hidden" id="gateTab"><a data-toggle="tab" href="#gate">Gate</a></li>
      <li><a data-toggle="tab" href="#plotX">Projection X</a></li>
      <li><a data-toggle="tab" href="#plotY">Projection Y</a></li>
      <li><a data-toggle="tab" href="#importNewData">Import/Save</a></li>
    </ul>
    <div style="padding-left: 15px; width: 259px; float: left;">
      <br>
      <div id="loadingBar" class="progress progress-striped active hidden">
        <div class="progress-bar progress-bar-success" role="progressbar" style="width: 0%">
        </div>
      </div>
      <div class="btn-group">
        <div id="startGatingX" type="button" class="btn btn-default">Gate X</div>
        <div id="startGatingY" type="button" class="btn btn-default">Y</div>
        <div id="updateChannels" type="button" class="btn btn-default" type="button">Update</div>
        <div id="drawButton" type="button" class="btn btn-success">Create</div>
      </div>
      <br><br>
      <fieldset class="input-group-vertical">
        <div class="input-group tomakesmaller">
          <table>
            <tr>
              <td>
                <label>X</label>
              </td>
              <td>
                <input style="width: inherit;" type="range" id="nCanaliXSlider" value="1000" min="100" max="3200" step="100" oninput="channelUpdate('X',value)">
              </td>
              <td style="width: 10px;"></td>
              <td>
                <input style="width: 45px; border-radius: 1px;" id="nCanaliX" type="text" value="1000" oninput="channelUpdate('XSlider',value)">
              </td>
            </tr>
            <tr>
              <td>
                <label>Y</label>
              </td>
              <td>
                <input style="width: inherit;" type="range" id="nCanaliYSlider" value="1000" min="100" max="3200" step="100" oninput="channelUpdate('Y',value)">
              </td>
              <td style="width: 10px;"></td>
              <td>
                <input style="width: 45px; border-radius: 1px;" id="nCanaliY" type="text" value="1000" oninput="channelUpdate('YSlider',value)">
              </td>
            </tr>
            <tr id="gatingSlider" class="hidden">
              <td>
                <label>Gate</label>
              </td>
              <td>
                <input style="width: inherit;" type="range" id="nCanaliGatingSlider" value="1000" min="100" max="3200" step="100" oninput="channelUpdate('Gating',value)">
              </td>
              <td style="width: 10px;"></td>
              <td>
                <input style="width: 45px; border-radius: 1px;" id="nCanaliGating" type="text" value="1000" oninput="channelUpdate('GatingSlider',value)">
              </td>
            </tr>
            <tr>
              <td> <label>Binning:<label></td>
              <td>
                &nbsp;4&nbsp;&nbsp;<input name="binning" type="radio" value="8000" onclick="channelUpdate('X',value); channelUpdate('Y',value); channelUpdate('XSlider',value); channelUpdate('YSlider',value)">
                &nbsp;8&nbsp;&nbsp;<input name="binning" type="radio" value="4000" onclick="channelUpdate('X',value); channelUpdate('Y',value); channelUpdate('XSlider',value); channelUpdate('YSlider',value)">
              </td>
            </tr>
            <tr>
              <td></td>
              <td>
                16&nbsp;<input name="binning" type="radio" value="2000" onclick="channelUpdate('X',value); channelUpdate('Y',value); channelUpdate('XSlider',value); channelUpdate('YSlider',value)">
                32&nbsp;<input name="binning" type="radio" value="1000" onclick="channelUpdate('X',value); channelUpdate('Y',value); channelUpdate('XSlider',value); channelUpdate('YSlider',value)">
              </td>
            </tr>
          </table>
        </div>
        <br>
        <label><input type="checkbox" id="invertColor" > Invert colors</label><br>
                <label><input type="checkbox" id="invertAxes" > Invert axes</label>
      </fieldset>
      <span>Save as png:</span>
      <div class="btn-group">
        <div type="button" class="btn btn-sm btn-default" id="saveMatrix">Matrix</div>
        <div type="button" class="btn btn-sm btn-default" id="saveX">Plot x</div>
        <div type="button" class="btn btn-sm btn-default" id="saveY">Plot y</div>
      </div>
      <br><br>
      <div id="backgroundRemovalDiv" class="hidden">
        <label>Sample points: <input name="bgPoints" id="bgPoints" type="number" value="100"/></label>
        <label>Iterations: <input name="bgIterations" id="bgIterations" type="number" value="10"/></label>
        <div type="button" class="btn btn-sm btn-warning" id="backgroundRemovalCancel">Cancel</div>
        <div type="button" class="btn btn-sm btn-success" id="backgroundRemovalConfirm">Remove background</div>
      </div>
      <div id="autoPeaksDiv" class="hidden">
        <label>Window: <input name="bgWindow" id="bgWindow" type="number" value="50"/></label>
        <label>Treshold: <input name="bgTreshold" id="bgTreshold" type="number" value="300"/></label>
        <div type="button" class="btn btn-sm btn-warning" id="autoPeaksCancel">Cancel</div>
        <div type="button" class="btn btn-sm btn-success" id="autoPeaksConfirm">Get peaks</div>
      </div>
      </div>
      <div class="col-sm-9">
        <div class="tab-content" style="width: 99%">
          <div id="matrix" class="tab-pane fade in active">
            <div id="dataVis"></div>
          </div>
          <div id="gate" class="tab-pane fade">
            <div id="gatePlotVis"></div>
            <div class="btn-group">
              <div data-filename="gating" type="button" class="btn btn-sm btn-default hidden backgroundRemoval">Remove background</div>
              <div data-filename="gating" type="button" class="btn btn-sm btn-default hidden autoPeaks">Get Peaks</div>
            </div>
            <div id="foundPeaksBoxgating" class="hidden box">
              <div id="foundPeaksBoxTitle">Found peaks: </div>
            </div>
          </div>
          <div id="plotX" class="tab-pane fade">
            <div id="xPlotVis"></div>
            <div class="btn-group">
              <div data-filename="xResult" type="button" class="btn btn-sm btn-default hidden backgroundRemoval">Remove background</div>
              <div data-filename="xResult" type="button" class="btn btn-sm btn-default hidden autoPeaks">Get Peaks</div>
            </div>
            <div id="foundPeaksBoxxResult" class="hidden box">
              <div id="foundPeaksBoxTitle">Found peaks:</div>
            </div>
          </div>
          <div id="plotY" class="tab-pane fade">
            <div id="yPlotVis"></div>
            <div class="btn-group">
              <div data-filename="yResult" type="button" class="btn btn-sm btn-default hidden backgroundRemoval">Remove background</div>
              <div data-filename="yResult" type="button" class="btn btn-sm btn-default hidden autoPeaks">Get Peaks</div>
            </div>
            <div id="foundPeaksBoxyResult" class="hidden box">
              <div id="foundPeaksBoxTitle">Found peaks: </div>
            </div>
          </div>
          <div id="importNewData" class="tab-pane fade">
            <br>
            <div>
              <div id="saveDb" type="button" class="btn btn-default"><span class="glyphicon glyphicon-floppy-disk"></span>&nbsp;Save current dataset </div>
            </div>
            <hr>
            <div id="newDataText">Create new dataset</div>
            <input id="file1" type="file" class="filestyle" data-buttonText="&nbsp;File 1" data-size="sm">
            <input id="file2" type="file" class="filestyle" data-buttonText="&nbsp;File 2" data-size="sm">
            <div id="createDataButton" type="button" class="btn btn-default">Import</div>
            <br>
            <hr>
            <div id="newDataText">Import existing dataset</div>
            <input id="dbFile" type="file" class="filestyle" data-buttonText="&nbsp;File 1" data-size="sm">
            <div id="importDbButton" type="button" class="btn btn-default">Import</div>
            <!--<input id="file3" type="file" class="filestyle" data-buttonText="&nbsp;Data&nbsp;" data-size="sm">-->
          </div>
        </div>
      </div>
    </div>
    <script>
      window.jQuery = window.$ = require('jquery');

      function channelUpdate(x, value) {
        $('#nCanali' + x).val(value);
      }
    </script>
    <script type="text/javascript" src="js/bootstrap.min.js"></script>
    <script type="text/javascript" src="js/plotly.min.js"></script>
    <script type="text/javascript" src="js/bootstrap-filestyle.min.js"></script>
    </script>
    <script>
      require('./helpers.js');
    </script>
    <script>
      require('./index.js');
    </script>
</body>

</html>